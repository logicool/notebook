# 你不知道的JS

## LHS引用和RHS引用

### 1.什么是LHS和RHS

例如：`var a = 2;`编译器会进行如下操作：
> 变量的赋值操作会执行两个动作， 首先编译器会在当前作用域中声明一个变量（如果之前没有声明过）， 然后在运行时引擎会在作用域中查找该变量， 如果能够找到就会对它赋值。

在第二步中，引擎需要判断变量a是否被声明过，这一查找过程由作用域协助。
这里引擎进行了LHS查询，而另一种查询叫做RHS查询。他们分别代表‘左侧’和‘右侧’，那么是什么的左侧和右侧呢？*是一个赋值操作的左侧和右侧*。可以将 RHS 理解成 retrieve his source value（ 取到它的源值）， 这意味着“得到某某的值”。

> LHS 和 RHS 的含义是“赋值操作的左侧或右侧” 并不一定意味着就是“=赋值操作符的左侧或右侧”。 赋值操作还有其他几种形式， 因此在概念上最好将其理解为“赋值操作的目标是谁（LHS）” 以及“谁是赋值操作的源头（RHS）”。

### 2.什么是作用域嵌套

> 引擎从当前的执行作用域开始查找变量， 如果找不到，就向上一级继续查找。 当抵达最外层的全局作用域时， 无论找到还是没找到， 查找过程都会停止。

### 3.异常

如果 RHS 查询在所有嵌套的作用域中遍寻不到所需的变量， 引擎就会抛出`ReferenceError`异常。

在 **非严格模式** 下，当引擎执行 LHS 查询时， 如果在顶层（全局作用域） 中也无法找到目标变量，全局作用域中就会创建一个具有该名称的变量， 并将其返还给引擎。

在 **严格模式** 下，当LHS 查询失败时， 并不会创建并返回一个全局变量， 引擎会抛出同 RHS 查询失败时类似的 `ReferenceError` 异常。

如果 RHS 查询找到了一个变量， 但是你尝试对这个变量的值进行不合理的操作，比如试图对一个非函数类型的值进行函数调用， 或着引用 `null` 或 `undefined` 类型的值中的属性，那么引擎会抛出另外一种类型的异常， 叫作 `TypeError。`

> 所以，`ReferenceError` 同作用域判别失败相关， 而 `TypeError` 则代表作用域判别成功了， 但是对结果的操作是非法或不合理的。

## 函数作用域和块作用域